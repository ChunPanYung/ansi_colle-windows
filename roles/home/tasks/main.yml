---
# tasks file for home_config
- name: Enable UTC time in Windows
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Control\TimeZoneInformation
    name: RealTimeIsUniversal
    data: 1
    type: dword

- name: Create folder for development
  ansible.windows.win_file:
    path: "{{ item }}"
    state: directory
  loop:
    - "{{ ansible_user_dir }}\\.ssh"
    - "{{ ansible_user_dir }}\\Repos"

- name: Create folder for PowerShell settings
  ansible.windows.win_file:
    path: "{{ home_pwsh_dir }}"
    state: directory

- name: Copy profile.ps1
  ansible.windows.win_copy:
    src: profile.ps1
    dest: "{{ home_pwsh_dir }}\\Microsoft.PowerShell_profile.ps1"

- name: Setup user PATH environment variable
  ansible.windows.win_path:
    scope: user
    elements:
      - "{{ ansible_env.LOCALAPPDATA }}\\User32"
      - "{{ ansible_env.LOCALAPPDATA }}\\Microsoft\\WindowsApps"

- name: Setup environment variables for current user
  ansible.windows.win_environment:
    level: user
    variables:
      PIPX_BIN_DIR: "{{ ansible_env.LOCALAPPDATA }}\\User32"
      PIPX_MAN_DIR: "{{ ansible_env.LOCALAPPDATA }}\\pipx\\man"
